<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Order - Dancakes Coffee & Bakery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initAutocomplete" async defer></script>
    <style>
        /* Custom Colors */
        :root {
            --primary-bg: #5f4630;
            --secondary-bg: #e6e1db;
            --accent-color: #bc8d64;
            --highlight-color: #c8a989;
        }

        body {
            background-color: var(--secondary-bg);
        }

        header {
            background-color: var(--primary-bg);
        }

        footer {
            background-color: var(--primary-bg);
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--highlight-color);
        }

        .text-primary {
            color: var(--primary-bg);
        }

        .text-accent {
            color: var(--accent-color);
        }

        .bg-secondary {
            background-color: var(--secondary-bg);
        }

        .bg-highlight {
            background-color: var(--highlight-color);
        }
    </style>
</head>
<body class="bg-secondary">

    <!-- Header -->
    <header class="text-white py-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold">Dancakes Coffee & Bakery</h1>
            <nav>
                <a href="/" class="text-white hover:underline">Home</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-10">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">

            <h2 class="text-2xl font-semibold mb-6 text-center text-primary">Order Your Delights</h2>

            <!-- Order Form -->
            <form action="#" method="POST" class="bg-white p-6 rounded-lg shadow-lg space-y-6">

                <!-- Delivery Details -->
                <section class="space-y-4">
                    <h3 class="text-xl font-medium text-primary">Delivery Details</h3>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="col-span-1">
                            <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                            <input type="text" id="name" name="name" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required>
                        </div>
                        <div class="col-span-1">
                            <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                            <input type="text" id="phone" name="phone" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="col-span-1">
                            <label for="address" class="block text-sm font-medium text-gray-700">Delivery Address</label>
                            <input type="text" id="address" name="address" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required>
                        </div>
                        <div class="col-span-1">
                            <label for="city" class="block text-sm font-medium text-gray-700">City</label>
                            <input type="text" id="city" name="city" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm bg-gray-200 text-gray-500" value="Bloemfontein" readonly>
                        </div>
                    </div>
                </section>

                <!-- Delivery Instructions -->
                <section>
                    <h3 class="text-xl font-medium text-primary">Delivery Instructions</h3>
                    <textarea id="instructions" name="instructions" rows="4" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" placeholder="Enter any special delivery instructions..."></textarea>
                </section>

                <!-- Yoco Payment Integration Placeholder -->
                <section>
                    <h3 class="text-xl font-medium text-primary">Payment</h3>
                    <p class="text-gray-600">Use the button below to pay via Yoco.</p>

                    <!-- Yoco Payment Button (this is a placeholder for now) -->
                    <div id="yoco-payment-button" class="mt-4">
                        <!-- The button is now for both pay and submit -->
                        <button type="submit" class="w-full py-3 btn-primary rounded-md hover:bg-highlight transition">
                            Pay and Place Order
                        </button>
                    </div>
                </section>

            </form>

        </div>
    </main>

    <!-- Footer -->
    <footer class="text-white py-4">
        <div class="container mx-auto text-center">
            <p>Dancakes Coffee & Bakery</p>
        </div>
    </footer>

    <script>
        function initAutocomplete() {
            const input = document.getElementById('address');
            const autocomplete = new google.maps.places.Autocomplete(input, {
                types: ['geocode'],
                componentRestrictions: { country: 'za' },
            });

            autocomplete.addListener('place_changed', function() {
                const place = autocomplete.getPlace();
                if (!place.geometry) {
                    console.log("No details available for the input address");
                    return;
                }
                console.log("Address details:", place);
            });
        }

        // Handle form submission
        document.querySelector("form").addEventListener("submit", function(event) {
            event.preventDefault();
            // Call the payment API (like Yoco) here before finalizing the order
            processPayment().then(() => {
                // Once payment is successful, submit the form
                this.submit();  // Submit the form after payment
            }).catch((error) => {
                console.error("Payment failed:", error);
                alert("There was an error processing your payment. Please try again.");
            });
        });

        function processPayment() {
            return new Promise((resolve, reject) => {
                // Simulate payment process
                setTimeout(() => {
                    console.log("Payment processed successfully");
                    resolve();
                }, 2000);  // Simulated delay for payment
            });
        }
    </script>
</body>
</html>
